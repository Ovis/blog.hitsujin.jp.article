---
Title: Surface Pro他タブレットPCでディスプレイの電源を切るとスリープになる問題の対応
Published: 2020/03/29 18:24:42
Tags:
  - "Windows"
  - "備忘録"
Eyecatch: ""
---
<p>前回こんなアプリを作ったわけなんですが、</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fblog.hitsujin.jp%2Fentry%2F2020%2F03%2F26%2F221031" title="指定時間にディスプレイの電源をオンオフするだけのミニツールを作るなどした - Pandora Pocket" class="embed-card embed-blogcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>実際に使いたかった<a class="keyword" href="http://d.hatena.ne.jp/keyword/Surface">Surface</a> Pro3でこのアプリを使ってディスプレイの電源を切ると、ディスプレイのみならず本体自体がスリープモードに入ってしまい、意味をなさないことが判明しました。</p>

<ul class="table-of-contents">
<li><a href="#原因">原因</a></li>
<li><a href="#対策">対策</a></li>
<li><a href="#参考サイト">参考サイト</a></li>
</ul>

<h4 id="原因">原因</h4>

<p>これは<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>の機能であるInstantGo(旧Connected Standby)によるもの。<br />
ディスプレイを閉じた場合や電源ボタンを押して画面を消した状態でも<a class="keyword" href="http://d.hatena.ne.jp/keyword/WiFi">WiFi</a>の接続を維持し、メール等の受信をできるようにする機能なんですが、私の用途だと邪魔な機能。</p>

<p>InstantGoが有効かどうかは<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%DE%A5%F3%A5%C9%A5%D7%A5%ED%A5%F3%A5%D7%A5%C8">コマンドプロンプト</a>で <code>powercfg /a</code> を実行し、 <code>スタンバイ（S0低電力アイドル）ネットワークに接続されています</code> と表示されていたら有効と判定できます。</p>

<h4 id="対策">対策</h4>

<p>InstantGoは画面から無効化できないので、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%C8%A5%EA">レジストリ</a>をいじる必要があります。</p>

<p><code>HKEY_LOCAL_MACHINES\SYSTEM\CurrentControlSet\Control\Power</code> 配下に  <code>CsEnabled</code> という値があるので、これを1から0に値変更し、再起動することでInstantGoが無効化されます。</p>

<blockquote><p>Key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Power<br />
Entry: CsEnabled<br />
Type: REG_DWORD<br />
Data: 0 ( 無効）1 ( 有効）</p></blockquote>

<p>なお、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Surface">Surface</a> Pro3をUSB<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EA%A5%AB%A5%D0%A5%EA">リカバリ</a>メディアで初期化し、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>バージョンが1511の状態で上記<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%C8%A5%EA">レジストリ</a>をいじった後、1911にアップグレードした段階で設定がクリアされていたので、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>のアップグレードを行った場合はこの設定を再度行う必要がありそうです。</p>

<p>また、この設定をしたうえでディスプレイの電源を切り、タイマー等でディスプレイの電源をオンにした際、ロック画面が表示されることがありますが、こちらに関してはグループポリシーの <code>コンピューターの構成 &gt; 管理用テンプレート &gt; コントロールパネル &gt; 個人設定 &gt; ロック画面を表示しない</code> を有効にするか、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%C8%A5%EA">レジストリ</a>から <code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization</code> のNoLockScreenの値を1に設定することでロック画面が無効化されます。</p>

<blockquote><p>Key: HKEY_LOCAL_MACHINE\SOFTWARE\Policies\<a class="keyword" href="http://d.hatena.ne.jp/keyword/Microsoft">Microsoft</a>\<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>\Personalization<br />
Entry: NoLockScreen<br />
Type: REG_DWORD<br />
Data: 0 ( ロック画面有効）1 ( ロック画面無効）</p></blockquote>

<h4 id="参考サイト">参考サイト</h4>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.softantenna.com%2Fwp%2Ftips%2Fwindows-10-no-lock-window%2F" title="【Tips】Windows 10の起動時にロック画面を表示しない方法 | ソフトアンテナブログ" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

***