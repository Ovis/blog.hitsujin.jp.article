---
Title: 指定時間にディスプレイの電源をオンオフするだけのミニツールを作るなどした
Published: 2020/03/26 22:10:31
Tags:
  - "プログラミング"
  - "パソコン"
  - "Windows"
Eyecatch: ""
---
<p>普段テーブルの端に<a class="keyword" href="http://d.hatena.ne.jp/keyword/Surface">Surface</a> Proを置き、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Twitter">Twitter</a>クライアントを常時起動させつつ、音楽を再生したりしています。<br />
朝起きた時に夜中のツイートもささっと流し読みしたいので24時間電源を入れっぱなしなのですが、使っていない時間ずっとディスプレイがつきっぱなしなのは電気代がもったいない。かといって電源設定でディスプレイの電源を切る時間を設定すると、普段見たいときにいちいち画面タップするなりしないといけないので面倒。</p>

<p>というわけで、指定した時間にディスプレイの電源をオンオフするだけの機能を持ったタスクトレイ常駐アプリを作りました。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2FOvis%2FSleepyDisplay%2F" title="Ovis/SleepyDisplay" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

***

<p>そこまで作りこんでないので、時間設定は<a class="keyword" href="http://d.hatena.ne.jp/keyword/GUI">GUI</a>でなく <code>SleepyDisplay.exe.config</code> を直接編集する仕様です。気が向いたら<a class="keyword" href="http://d.hatena.ne.jp/keyword/GUI">GUI</a>を追加します。</p>

<blockquote><pre><code>{
"ExecTime": "01:00:00",
"Power": 0,
"Enabled": true
},
{
"ExecTime": "09:00:00",
"Power": 1,
"Enabled": true
}
</code></pre></blockquote>

<p>こんな感じで、<code>ExecTime</code>に時間を指定、 <code>Power</code>に0(電源オフ)または1(電源オン)、‘Enabled‘にtrue(無効化する際はfalse)を指定することで設定可能。</p>

<p>タスクトレイのアイコンの<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%C6%A5%AD%A5%B9%A5%C8%A5%E1%A5%CB%A5%E5%A1%BC">コンテキストメニュー</a>から直接手動でディスプレイの電源を切ることも可能になってます。</p>

<p><b>注意</b></p>

<p>InstantGo(Connected Standby)が有効になっている場合、ディスプレイの電源を切る処理でスリープが走ってしまいます。これは<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>の仕様なので、ディスプレイの電源だけを切りたいなら無効化してください。</p>
