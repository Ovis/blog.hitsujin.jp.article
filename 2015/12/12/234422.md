---
Title: 動画ファイルのコンテキストメニューに項目を追加する(Windows 10)
Published: 2015/12/12 23:44:22
Tags:
  - "備忘録"
  - "パソコン"
Eyecatch: ""
---
<p>以前
<iframe src="http://blog.thty.net/embed/2015/10/13/224851" title="【誰か教えて】音楽、動画関係のファイルのコンテキストメニューに項目を追加したい(Windows 10限定) - Pandora Pocket" class="embed-card embed-blogcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>という記事を書いていたのですが、あえとすさん(<a href="http://blog.hatena.ne.jp/aetos382/">id:aetos382</a>)から正しい登録方法を教えてもらいました。</p>

<blockquote><p>HKCR.ts の中に PerceivedType という値はありませんか。<br/>
この値がある場合、<br/>
HKCR\SystemFileAssociations.ts<br/>
または<br/>
HKCR\SystemFileAssociatons\<PerceivedType の値><br/>
の下の shell をいじってやるといいかもしれません。</p></blockquote>

<p>というわけで、以下のような<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%C8%A5%EA">レジストリ</a>を登録することでばっちり解決。</p>

<blockquote><p>[HKEY_CLASSES_ROOT\SystemFileAssociations\<a class="keyword" href="http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2">拡張子</a>\shell\適当な名前]<br/>
@="○○で開く"</p>

<p>[HKEY_CLASSES_ROOT\SystemFileAssociations\<a class="keyword" href="http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2">拡張子</a>\shell\適当な名前\command]<br/>
@="\"プログラムのパス"</p></blockquote>

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%C8%A5%EA">レジストリ</a>の中では個々の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2">拡張子</a>に対するもののほかに、動画や画像といった分類で紐づけることができるらしく(<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows%20XP">Windows XP</a>のころからこの仕組み）、私が紐づけたかったts<a class="keyword" href="http://d.hatena.ne.jp/keyword/%B3%C8%C4%A5%BB%D2">拡張子</a>もPerceivedTypeがVideoとして登録されていました。<br/>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows%208">Windows 8</a>.xまでは[HKEY_CLASSES_ROOT/.ts]のshellを直接変更するだけでもよかったのですが、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a> 10はだめになったんですかね。</p>

<p>参考:
<blockquote class="wp-embedded-content"><a href="http://sgry.jp/blog/2005/02/19/2567/">Windows XPの関連づけ設定の仕組み</a></blockquote><script type='text/javascript'><!--//--><![CDATA[//><!--!function(a,b){"use strict";function c(){if(!e){e=!0;var a,c,d,f,g=-1!==navigator.appVersion.indexOf("MSIE 10"),h=!!navigator.userAgent.match(/Trident.*rv:11\./),i=b.querySelectorAll("iframe.wp-embedded-content"),j=b.querySelectorAll("blockquote.wp-embedded-content");for(c=0;c<j.length;c++)j[c].style.display="none";for(c=0;c<i.length;c++)if(d=i[c],d.style.display="",!d.getAttribute("data-secret")){if(f=Math.random().toString(36).substr(2,10),d.src+="#?secret="+f,d.setAttribute("data-secret",f),g||h)a=d.cloneNode(!0),a.removeAttribute("security"),d.parentNode.replaceChild(a,d)}else;}}var d=!1,e=!1;if(b.querySelector)if(a.addEventListener)d=!0;if(a.wp=a.wp||{},!a.wp.receiveEmbedMessage)if(a.wp.receiveEmbedMessage=function(c){var d=c.data;if(d.secret||d.message||d.value)if(!/[^a-zA-Z0-9]/.test(d.secret)){var e,f,g,h,i,j=b.querySelectorAll('iframe[data-secret="'+d.secret+'"]'),k=b.querySelectorAll('blockquote[data-secret="'+d.secret+'"]');for(e=0;e<k.length;e++)k[e].style.display="none";for(e=0;e<j.length;e++)if(f=j[e],c.source===f.contentWindow){if(f.style.display="","height"===d.message){if(g=parseInt(d.value,10),g>1e3)g=1e3;else if(200>~~g)g=200;f.height=g}if("link"===d.message)if(h=b.createElement("a"),i=b.createElement("a"),h.href=f.getAttribute("src"),i.href=d.value,i.host===h.host)if(b.activeElement===f)a.top.location.href=d.value}else;}},d)a.addEventListener("message",a.wp.receiveEmbedMessage,!1),b.addEventListener("DOMContentLoaded",c,!1),a.addEventListener("load",c,!1)}(window,document);//--><!]]></script><iframe sandbox="allow-scripts" security="restricted" src="http://sgry.jp/blog/2005/02/19/2567/embed/" width="600" height="338" title="埋め込まれた WordPress の投稿" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" class="wp-embedded-content"></iframe></p>

***