---
Title: Windows 8でもMicrosoft DTV-DVD Video decoderは使える
Published: 2012/11/04 14:11:21
Tags:
  - "備忘録"
Eyecatch: ""
---
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows%208">Windows 8</a>になってから標準で<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%B3%A1%BC%A5%C0">デコーダ</a>ーが搭載されなくなりました。</p>
<p> </p>
<p>MediaPackを購入（期間限定で無料配布していますが）すればいいわけですが、たとえMedia PackをインストールしてもTVTestで<a class="keyword" href="http://d.hatena.ne.jp/keyword/Microsoft">Microsoft</a> DTV-DVD Video decoderを利用することができませんでした。</p>
<p>ええいMSめ、MediaCenterだけしか使えなくしたのか馬鹿野郎！！！と思っていたんですがどうやらTVTestの問題だったようで・・・。</p>
<p> </p>
***



<p> </p>
<p> </p>
<p> </p>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/%A3%B2%A4%C1%A4%E3%A4%F3%A4%CD%A4%EB">２ちゃんねる</a>のTVTestスレッドによれば</p>
<blockquote>836 名前：名無しさん＠編集中[sage] 投稿日：2012/11/04(日) 00:32:10.71 ID:974JLHGF [1/4]</blockquote>
<p>&gt;&gt;834</p>
<p>見てはいけないものを見てしまいましたね…</p>
<p> </p>
<p>まるもスプリッター弄ってるうちに気づいたのだが</p>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/Win8">Win8</a>でMediaCenterのDTV-DVD使えないのは単にTVTestのメディアタイプ設定バグみたい↓</p>
<p>--- BonTsEngine/MediaViewer.cpp.orig</p>
<p>+++ BonTsEngine/MediaViewer.cpp</p>
<p>@@ -40,6 +40,7 @@</p>
<p>// ビデオヘッダ設定</p>
<p>VIDEOINFOHEADER2 &amp;VideoHeader = pVideoInfo-&gt;<a class="keyword" href="http://d.hatena.ne.jp/keyword/hdr">hdr</a>;</p>
<p>//::SetRect(&amp;VideoHeader.rcSource, 0, 0, Width, Height);</p>
<p>+ VideoHeader.bmiHeader.biSize = sizeof(BITMAPINFOHEADER);</p>
<p>VideoHeader.bmiHeader.biWidth = Width;</p>
<p>VideoHeader.bmiHeader.biHeight = Height;</p>
<p>要全角スペース置換。既出かしらんがビルドのついでにパッチしとくと吉。</p>
<p> </p>
<p>あと<a class="keyword" href="http://d.hatena.ne.jp/keyword/Win8">Win8</a>+VS2010Expressでビルド中によく「mt.exe はコード 31 を伴って終了」しちゃうから</p>
<p>そういう時は一時的に<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a> Defenderのリアルタイム保護切ったらいける(糞環境乙かも)</p>
<p>とのこと。ソースに一行追加すれば動くようになります。</p>
<p> </p>
<p>以下備忘録</p>
<p> </p>
<p>私はTSファイル再生にTvtPlayを利用していますがオリジナルTVTestはTvtPlayを利用すると起動時に少しの間フリーズする問題が生じていました。この問題はTvtPlayについて語るスレでTvtPlayの作者さんが解決策を掲示してくださっています。</p>
<blockquote>17 名前：名無しさん＠編集中[sage] 投稿日：2012/09/26(水) 20:35:10.50 <a href="http://blog.hatena.ne.jp/nAM5OwYU/">id:nAM5OwYU</a> [2/3]</blockquote>
<p>affinity関連のレス読んでて、起動時フリーズ問題は<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AF%A5%EA%A5%C6%A5%A3%A5%AB%A5%EB%A5%BB%A5%AF%A5%B7%A5%E7%A5%F3">クリティカルセクション</a>関連が原因かと思って</p>
<p>コード色々読み返してみたら、やっぱAacDecFilter.cppが怪しいかなという感じになった。</p>
<p>とりあえず↓でこちらでは全く発生しなくなった。</p>
<p>ttp://www1.axfc.net/uploader/Sc/so/381174</p>
<p>こういう問題は凄く環境依存だと思うので的外してるかも。暇なときに試してみてほしいです。</p>
<p> </p>
<p>まとめると倍速再生時のドロップ部分での<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%C3%A5%C9%A5%ED%A5%C3%A5%AF">デッドロック</a>や起動時フリーズに対しては</p>
<p>いまのところ上の改変TVTestが最善、設定キーRaiseMainThreadPriority=1が次善という今のところの結論</p>
<p>今回はこちらもfixしたTVTestを<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB">コンパイル</a>することにしました。</p>
<p> </p>
<p>用意するものは</p>
<blockquote>・<a href="http://www1.axfc.net/uploader/so/2637448.7z" target="_blank">TVTest 0.80ソースコード</a></blockquote>
<p>・<a href="http://www1.axfc.net/uploader/Sc/so/381174" target="_blank">フリーズ問題解決ファイル</a></p>
<p>・<a class="keyword" href="http://d.hatena.ne.jp/keyword/Visual%20Studio">Visual Studio</a></p>
<p>・<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a> <a class="keyword" href="http://d.hatena.ne.jp/keyword/SDK">SDK</a> for <a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows%207">Windows 7</a></p>
<p>・<a href="http://www.audiocoding.com" target="_blank">faad2</a></p>
<p>・<a href="http://www1.axfc.net/uploader/so/2637449" target="_blank">tvcas_attachment_20120915.7z</a></p>
<p>今回は<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows%208">Windows 8</a>、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Visual%20Studio">Visual Studio</a> 2012 Ultimateで<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB">コンパイル</a>しています。</p>
<p>基本的にReadme_<a class="keyword" href="http://d.hatena.ne.jp/keyword/asc">asc</a>.txtに載っているビルド方法と一緒です。先にlibfaad2libとbaseclassesをビルドしておき、フリーズ問題解決のファイルはTVTestのソースに上書きしておいてからVSを起動します。ファイルが古いと怒られるのでそのまま変換ウィザードにお任せします。プロパティで</p>
<p>構成プロパティ⇒リンカー⇒入力⇒特定の既定のライブラリの無視</p>
<p>へLIBCMT.libと入力しておけばあとはビルド方法に書かれたことを行うだけ。ちゃんとビルドされました。</p>