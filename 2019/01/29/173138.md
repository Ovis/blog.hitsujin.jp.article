---
Title: Linuxで動かす.NET CoreアプリではTimeZoneInfo.FindSystemTimeZoneById(&quot;Tokyo Standard Time&quot;)が使えない
Published: 2019/01/29 17:31:38
Tags:
  - "プログラミング"
  - "備忘録"
Eyecatch: ""
---
<p>もともとAzure Functionsで動かしていたアプリを<a class="keyword" href="http://d.hatena.ne.jp/keyword/Linux">Linux</a>上に持って行った際、下記のようなエラーが発生しました。</p>

<p><script src="https://gist.github.com/Ovis/fe76308522e4649fd6cb50b0bc4dddbf.js"> </script></p>

***

<p>エラーが発生した箇所の実装は下記の通り。<br/>
<script src="https://gist.github.com/Ovis/47eb9973e3a63d3807b419c3c9ee03dc.js"> </script></p>

<p>結論としては、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>では日本の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3">タイムゾーン</a>として「Tokyo Standard Time」が定義されているものの、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Linux">Linux</a>(少なくとも<a class="keyword" href="http://d.hatena.ne.jp/keyword/Ubuntu">Ubuntu</a> 18.04では)では下記の項目しか存在しないことにより、未定義エラーが出ていたようです。</p>

<p><script src="https://gist.github.com/Ovis/acb014b4536fe60978b000906b0d0ee5.js"> </script></p>

<p>そりゃ存在しない以上エラーも吐きます。</p>

<p>「Japan」と記載しておけばいいのでしょうが、それだと<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>環境では動かなくなってしまいます。</p>

<p>解決策を探したところ、MSのブログを発見。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fdotnet%2F2018%2F11%2F13%2Fcross-platform-time-zones-with-net-core%2F" title="Cross-platform Time Zones with .NET Core" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>こちらではTimeZoneConverterというライブラリを用いる方法を紹介しています。<br/>
内部的に<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3">タイムゾーン</a>と<a class="keyword" href="http://d.hatena.ne.jp/keyword/Linux">Linux</a>の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3">タイムゾーン</a>を<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%DE%A5%C3%A5%D4%A5%F3%A5%B0">マッピング</a>させているようです。</p>

<p>さっそくNuGetで参照し、下記のように実装を修正。</p>

<p><script src="https://gist.github.com/Ovis/a589e368d05a6ebfd5567352071a7043.js"> </script></p>

<p>この修正でエラーが発生しなくなりました。</p>
