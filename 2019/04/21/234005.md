---
Title: クエリ文字列を生成するときのメモ(C#)
Published: 2019/04/21 23:40:05
Tags:
  - "プログラミング"
Eyecatch: ""
---
<p>クエリ文字列(クエリストリング、URLパラメータとも)は</p>

<blockquote><p><a href="http://www.">http://www.</a>〇〇〇.com/search.<a class="keyword" href="http://d.hatena.ne.jp/keyword/php">php</a>?△△=〇×</p></blockquote>

<p>の?以降のこと。サーバーに情報を送るための文字列になります。</p>

<p>StringBuilderで
strBuilder.Append("△△=〇×");
とか、Dictionary使ってよく生成してたんですが、特殊記号や全角文字列の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9">エス</a>ケープ処理を別途行う必要があるので面倒くさい。</p>

<blockquote><p>System.Web.HttpUtility.ParseQueryString</p></blockquote>

<p>を使えば<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A8%A5%B9">エス</a>ケープ処理を自動的にやってくれる。</p>

<blockquote><p>using System.Web;<br/>
中略<br/>
var queryString = HttpUtility.ParseQueryString("");<br/>
queryString.Add("△△", "〇×");</p></blockquote>

<p>としてやれば、</p>

<blockquote><p>queryString.ToString();</p></blockquote>

<p>でクエリ文字列が生成される。</p>

<p>下記のようにUriBuilderに渡してやれば、スマートにURLが生成可能。</p>

<blockquote><p>var uriBuilder = new System.UriBuilder("www.〇〇〇.com") {Query = queryString.ToString() };</p></blockquote>

<p>ちょくちょく忘れるのでメモメモ。</p>

***