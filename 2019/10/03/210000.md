---
Title: 画像ファイル(JPEGファイル、RAWファイル)の更新日時をEXIFの撮影日時に書き換えたいときの備忘録
Published: 2019/10/03 21:00:00
Tags:
  - "写真"
  - "備忘録"
  - "Windows"
Eyecatch: ""
---
<p>これまで撮りためてきた画像ファイルを保存していた<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>がぶっ飛んで、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Amazon%20Prime">Amazon Prime</a> Driveから復元した際、ファイルの更新日時が狂ってしまいました。<br/>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/EXIF">EXIF</a>自体は生きてるので、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A8%A5%AF%A5%B9%A5%D7%A5%ED%A1%BC%A5%E9">エクスプローラ</a>の表示列に撮影日時を追加してやればソートもできるんですが、できれば更新日時もそろえておきたかったので、対応した方法を備忘録がてら。</p>

***

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/JPEG">JPEG</a>ファイルはちょっと調べただけでも複数ソフトが出てくるので、お好きなものを使えばいいかと。<br/>
私はF6Exifというソフトを使いました。<a class="keyword" href="http://d.hatena.ne.jp/keyword/JPEG">JPEG</a>ファイルだけならこれで十分かと。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=http%3A%2F%2Fwww.ryouto.jp%2Ff6exif%2F" title="F6 Exif 〜EXIF編集ソフト〜" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>困ったのがRAWファイル。私は<a class="keyword" href="http://d.hatena.ne.jp/keyword/Nikon">Nikon</a>ユーザーなので、拡張子がNEFなRAWファイルなんですが、上記のソフトは非対応。<br/>
いろいろググってたらExiv2という<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%DE%A5%F3%A5%C9%A5%E9%A5%A4%A5%F3">コマンドライン</a>ツールを発見。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.exiv2.org%2F" title="Exiv2 - Image metadata library and tools" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/EXIF">EXIF</a>をはじめとする画像ファイルの<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%E1%A5%BF%A5%C7%A1%BC%A5%BF">メタデータ</a>を更新するための<a class="keyword" href="http://d.hatena.ne.jp/keyword/C%2B%2B">C++</a>ライブラリらしいんですが、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>向けの<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%DE%A5%F3%A5%C9%A5%E9%A5%A4%A5%F3">コマンドライン</a>ツールも配布されています。</p>

<p>この<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%DE%A5%F3%A5%C9%A5%E9%A5%A4%A5%F3">コマンドライン</a>ツールの「-T」オプションがファイルタイムスタンプ更新となっているので、下記のように指定してやれば撮影日時で更新日時が置き換えられます。</p>

<p><code>exiv2.exe -T ファイル名</code></p>

<p>なので、下記のようなコマンドを実行してやれば、カレント<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%A3%A5%EC%A5%AF%A5%C8">ディレクト</a>リ内のサブ<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C7%A5%A3%A5%EC%A5%AF%A5%C8">ディレクト</a>リまで検索して一括で<a class="keyword" href="http://d.hatena.ne.jp/keyword/JPEG">JPEG</a>、RAWファイルの更新日時を撮影日時で置き換えてくれます。便利。</p>

<p><code>for /R %%f in (*.jpg, *.nef) do exiv2.exe /T "%%f"</code><br/>
(注:バッチでなく<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B3%A5%DE%A5%F3%A5%C9%A5%D7%A5%ED%A5%F3%A5%D7%A5%C8">コマンドプロンプト</a>で実行する際は%を一つ取ってください。Exiv2にパスが通っていない場合は<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C0%E4%C2%D0%A5%D1%A5%B9">絶対パス</a>指定するなどしてください。)</p>

<p>私の場合<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>にあるファイルだったので、あらかじめ <code>pushd</code> のコマンドでRAWイメージの置いてあるフォルダをネットワークドライブとしてマウントしてから実行。</p>

<p>コマンドサンプル</p>

<blockquote><p>set path=%path%;D:\Exiv2\bin\<br/>
pushd \<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>\Images\<br/>
for /R %f in (*.nef) do exiv2.exe /T "%f"</p></blockquote>
