---
Title: タスクスケジューラの一括インポート、エクスポートでどがらじの録音予約をバックアップ、復元する
Published: 2019/06/30 21:44:16
Tags:
  - "録画環境"
  - "備忘録"
  - "パソコン"
Eyecatch: ""
---
<p>録画マシンをこれまでより小型のものにするべく、データの移行をしておりまして、ちょっと迷ったので備忘録。</p>

<p>録画マシンではMirakurun、EDCBを利用したテレビの録画と、どがらじを利用したラジオの録音を行っています。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fdogaradi.123net.jp%2F" title="どがらじ | 観る・聴く・録画・録音・整理・簡単・無料！" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>テレビ録画のほうは、AppData内のデータとプログラムフォルダをそのままコピーしてやればいいんですが、どがらじの場合、AppDataの中身をコピーしただけだと、録音予約が移行できません。</p>

<p>最初なんでやと思っていたのですが、よくある質問に書いてありました。</p>

<blockquote><p>なぜ管理者権限が必要なんですか？</p>

<p>ラジオの予約録音には<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>のタスクスケジューラが使用されています。環境や状況によって、タスクスケジューラへのタスクの追加や削除に管理者権限が必要だからです。</p></blockquote>

<p>というわけで、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Windows">Windows</a>のタスクスケジューラ機能を利用しているため、単にフォルダコピーだけでは移行できないということです。</p>

<p>さて、タスクスケジューラなんですが、番組ごとにスケジュールが作成されるため、番組分のスケジュールをエクスポート、インポートする必要があります。<br/>
残念ながら標準機能では一括エクスポート、インポートができません。</p>

***

<h4><a class="keyword" href="http://d.hatena.ne.jp/keyword/PowerShell">PowerShell</a>で一括エクスポート</h4>

<p>とはいえタスクスケジュールの処理はコマンドで対応可能なため、バッチを作ってやれば可能です。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=http%3A%2F%2Fnotshown.hatenablog.jp%2Fentry%2F2016%2F09%2F29%2F103841" title="Powershellでタスクスケジューラのタスクをまとめてエクスポートするスクリプト - 命名って難しい" class="embed-card embed-blogcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>こちらのブログ記事を参考に、一括でスケジュールをエクスポートする<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8">スクリプト</a>を実行します。</p>

<p><script src="https://gist.github.com/Ovis/9d2da3afa8a217e428da4891a3ac3860.js"> </script></p>

<p>どがらじではタスクスケジューラに専用のフォルダを設けて、その中にスケジュールを作成しているので、どがらじスケジュールだけ取得可能なように元記事のベースパスを変更しています。</p>

<h4><a class="keyword" href="http://d.hatena.ne.jp/keyword/PowerShell">PowerShell</a>で一括インポート</h4>

<p>エクスポートできたら新しいマシンへのインポートです。</p>

<p>が、エクスポートした<a class="keyword" href="http://d.hatena.ne.jp/keyword/XML">XML</a>ファイルをそのままインポートすることはできません。<br/>
なにせマシンが違うので、ユーザーのUIDが変わってますので。</p>

<p>というわけで、一度新マシンにインストールしたどがらじで適当に録音予約を作って、そのスケジュールを一度エクスポートしてください。<br/>
エクスポートした<a class="keyword" href="http://d.hatena.ne.jp/keyword/XML">XML</a>ファイルを開くと、<br/>
<script src="https://gist.github.com/Ovis/1b1620a27ff21b8b23a4c16ab1f50411.js"> </script><cite class="hatena-citation"><a href="https://gist.github.com/Ovis/1b1620a27ff21b8b23a4c16ab1f50411">gist.github.com</a></cite></p>

<p>のように、UserIDが記載されているので、これをコピーして、先にエクスポートしていた<a class="keyword" href="http://d.hatena.ne.jp/keyword/XML">XML</a>ファイルの同じ場所を先ほどコピーしたUIDで置換します。<br/>
録画数x2やるのは面倒なので、エディタのファイルから置換の機能を使いましょう。</p>

<p>あとは上記ブログ記事にあったインポート用<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8">スクリプト</a>を少し書き換えた下記の<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8">スクリプト</a>を実行することで完了です。</p>

<p><script src="https://gist.github.com/Ovis/9d7a65289f1b12ffb37a931ef1cea8a3.js"> </script></p>

<p>WakeUpフォルダとRadioRecorderフォルダそれぞれに登録するために二回実行させているだけです。(どうせ一回しか使わないので冗長に丸っとコピーしてるだけ）</p>
