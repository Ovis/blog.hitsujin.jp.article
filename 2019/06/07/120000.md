---
Title: バックアップは多重化するべきだと実感した話
Published: 2019/06/07 12:00:00
Tags:
  - "VPS、クラウド"
  - "パソコン"
  - "雑記"
Eyecatch: ""
---
<p>普段大切なデータをどのようにバックアップしていますか？</p>

<p>私の場合、大切なデータとしては</p>

<ul>
<li>音楽ファイル(数年かけてレンタルなどして集めたCD音源の<a class="keyword" href="http://d.hatena.ne.jp/keyword/FLAC">FLAC</a>ファイルがだいたい400GBほど）</li>
<li>写真(家族写真や旅行へ行った時の写真など、<a class="keyword" href="http://d.hatena.ne.jp/keyword/JPEG">JPEG</a>ファイルとRAWファイル)</li>
<li>その他(<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C5%C5%BB%D2%BD%F1%C0%D2">電子書籍</a>のPDFファイル(<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AA%A5%E9%A5%A4%A5%EA%A1%BC">オライリー</a>とか)など)<br/>
があります。</li>
</ul>


<p>今回その大切なデータを失ってしまうところでした・・・。</p>

***

<h4>普段のバックアップ方法</h4>

<p>基本的に大切なデータはPCではなく、<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>に保管しています。<br/>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/RAID">RAID</a>を組んでいるのでPCよりも安全に保管できるためです。ただし、</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2F2502.net%2Fraid-is-not-a-backup%2F" title="RAIDはバックアップではない(ITエンジニアではない人向け)" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>といった記事があるように<a class="keyword" href="http://d.hatena.ne.jp/keyword/RAID">RAID</a>=バックアップではないことに留意する必要があります。<br/>
私の場合、自宅にある<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>が吹っ飛んでしまった時の対策として、実家にも<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>を配置し、Resiio Syncを使ってインターネット経由でファイルのバックアップを取るようにしていました。<br/>
が、あほなことに音楽ファイルだけしか実家<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>にバックアップを取っていませんでした。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.resilio.com%2F" title="Resilio: Faster file synchronization" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>写真データについては<a class="keyword" href="http://d.hatena.ne.jp/keyword/Amazon%20Prime">Amazon Prime</a>会員なので、Prime Driveの画像データ無制限特典が利用できることから、そちらにバックアップするようにしていました。</p>

<h4>ことの発端</h4>

<p>自宅で利用している<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>はNETGEARの<a class="keyword" href="http://d.hatena.ne.jp/keyword/ReadyNAS">ReadyNAS</a>になります。初めて購入した<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>で、スペック的には劣るものです。読み書きの速度があまりに遅くてイライラ・・・。  <br/>
それに対し、実家においてある<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>はQNAP製で、自宅の<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>より性能が良い。読み書きの速度も申し分なし。</p>

<p>普段使う<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>のほうが性能が悪いのはさすがにちょっと・・・というわけで、自宅の<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>と実家の<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>を取り換えることにしました。<br/>
また、どちらもRAID5だったので、性能と信頼性を鑑みてRAID10にすることに。<br/>
この場合再構築ができなそうなので、いったんボリュームを消して、新規に<a class="keyword" href="http://d.hatena.ne.jp/keyword/RAID">RAID</a>を構築することにしました。</p>

<p>ボリュームを消すのでデータをいったん退避する必要があります。<br/>
PCの内蔵ストレージだと<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>に保存していたファイルサイズ以上の空きがなかったので、現行メインPCを作り変える前に使用しており、今は不要となって外していたHDD(外付けケースに入れました)に一旦移すことに。<br/>
思えば数年使っていたHDDにコピーを行ったのが間違いでした。</p>

<h4>フォーマットする必要があります</h4>

<p>バックアップが終わって、自宅<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>を実家に持ち帰り、どちらの<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>もボリュームを削除して再度構築し終えたので、いざ退避していたデータを元に戻そうと思い、HDDをPCに接続してコピー開始。</p>

<p>途中まで<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>にコピーされていたのですが、突然コピーが失敗し、USB接続が切断されました。<br/>
特に重たい処理やUSBケーブルを触るようなことをしていないのにと思いつつケーブルをさしなおしたところ、</p>

<blockquote><p>ドライブ E: を使うにはフォーマットする必要があります。フォーマットしますか？</p></blockquote>

<p>のメッセージが。<br/>
は？<br/>
と思いもう一度つなぎなおしても、無情にも同じメッセージ。</p>

<p><blockquote class="twitter-tweet" data-lang="HASH(0x56055b3aa730)"><p lang="ja" dir="ltr"><a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>を初期化するために、<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>内のデータを移動させておいたHDDが認識<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C9%D4%C7%BD">不能</a>になって悲鳴を上げてる</p>&mdash; Ovis＠🐑のひと (@Pandora_Ovis) <a href="https://twitter.com/Pandora_Ovis/status/1136477127748927488?ref_src=twsrc%5Etfw">June 6, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>いやな予感しかしないまま<a class="keyword" href="http://d.hatena.ne.jp/keyword/CrystalDiskInfo">CrystalDiskInfo</a>を起動してみたところ、ステータスが注意、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C9%D4%CE%C9%A5%BB%A5%AF%A5%BF">不良セクタ</a>が200・・・。</p>

<p><blockquote class="twitter-tweet" data-lang="HASH(0x55ab87c9af70)"><p lang="ja" dir="ltr"><a class="keyword" href="http://d.hatena.ne.jp/keyword/%C9%D4%CE%C9%A5%BB%A5%AF%A5%BF">不良セクタ</a>できてるうううううううううううううううううううううう</p>&mdash; Ovis＠🐑のひと (@Pandora_Ovis) <a href="https://twitter.com/Pandora_Ovis/status/1136477529072476161?ref_src=twsrc%5Etfw">June 6, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>よりにもよってこのタイミングでHDDがお釈迦に・・・。</p>

<h4>復旧</h4>

<p>幸い音楽ファイルについては、先に自宅<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>を初期化し終えて実家<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>の初期化作業をする前に、<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>から<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>にコピーしていたので無事でした。  <br/>
写真データもPrime Photoにアップロードしてあるので、どうにかなりました。(ファイル更新日時がアップロードした日付になってしまって地味に辛い・・・)
が、残りのファイルはバックアップしていた記憶がありません。</p>

<p>しかもあほなことにいきなり <a class="keyword" href="http://d.hatena.ne.jp/keyword/chkdsk">chkdsk</a> /f をかけてしまったので、破損したところをがっしがっしとチェックディスクが消し込んでしまってフォルダ名やファイル名がぐちゃぐちゃに・・・。<br/>
まただいぶ破損の程度が悪いようで、フリーの復旧ソフトだとあまり復旧できそうにない。</p>

<p><blockquote class="twitter-tweet" data-lang="HASH(0x55ab87b50450)"><p lang="ja" dir="ltr">・音楽ファイルは実家<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>に多重保存していたから無事<br>・写真はAmazonPrimePhotoで多重管理してたから無事<br><br>最低限なんとしても残しておきたいものはちゃんと多重バックアップしてたので残ってる。やはりバックアップは大事。</p>&mdash; Ovis＠🐑のひと (@Pandora_Ovis) <a href="https://twitter.com/Pandora_Ovis/status/1136483026072825856?ref_src=twsrc%5Etfw">June 6, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p><blockquote class="twitter-tweet" data-lang="HASH(0x56117a4fc7d0)"><p lang="ja" dir="ltr">だがしかしそれ以外のものが吹っ飛んだのがじみに辛いぞ・・・</p>&mdash; Ovis＠🐑のひと (@Pandora_Ovis) <a href="https://twitter.com/Pandora_Ovis/status/1136483136764669954?ref_src=twsrc%5Etfw">June 6, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>割と途方に暮れつつ、仕方がないので破損HDDの<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AF%A5%E9%A5%B9%A5%BF">クラスタ</a>解析を行いつつ、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Amazon">Amazon</a> Photoからファイルダウンロードをしていたのですが、ふと<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>の管理画面をみてて、思い出しました。</p>

<p><blockquote class="twitter-tweet" data-lang="HASH(0x55d7d8e60518)"><p lang="ja" dir="ltr">あああああああああOneDriveにひと月前までのデータ残ってる！！！！！！！</p>&mdash; Ovis＠🐑のひと (@Pandora_Ovis) <a href="https://twitter.com/Pandora_Ovis/status/1136502482073374720?ref_src=twsrc%5Etfw">June 6, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>Office 365を契約して、OneDrive for Businessが使えるので、1TBの枠を何かに使えないかと思って、設定していたのでした。何気なく設定してたのでまったくそのことを覚えてなかった・・・。<br/>
(そもそも普段<a class="keyword" href="http://d.hatena.ne.jp/keyword/Dropbox">Dropbox</a>ばかり使っていて、OneDriveを使うことがないので、同期されているかの確認もしてなかった)</p>

<p>OneDriveを開くと、そこには消えてしまったと思っていたデータたちが。<br/>
一か月ほど前に<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>をいろいろいじった関係か、1か月前までのデータしかなかったのですが、この一か月以内にほとんどデータを保存してなかったこともあり、ほぼこれで取り返すことができました。</p>

<h4>教訓</h4>

<p>本当に必要なデータなら、複数のバックアップ先を用意しましょう(白目)。<br/>
そもそも実家<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>にすべてのデータを同期させていればこんなことにはならなかったわけなんですが、バックアップが一つだけというのは本当に心もとないものだと認識しました。<br/>
バックアップ先がぶっ壊れたら話にならないですね・・・。<br/>
試験的に設定して、そのあとほったらかしにしていたOneDriveへのバックアップがなかったら、データが取り戻せないところでした。</p>

<p>今後は実家<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>への<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%D5%A5%EB%A5%D0%A5%C3%A5%AF">フルバック</a>アップと、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AF%A5%E9%A5%A6%A5%C9">クラウド</a>へのバックアップを確実に行うようにしたいと思います。<br/>
OneDriveの1TBだと<a class="keyword" href="http://d.hatena.ne.jp/keyword/NAS">NAS</a>の容量に満たないので、<a class="keyword" href="http://d.hatena.ne.jp/keyword/AWS">AWS</a>のS3やAzureBlobも視野に入れようかと。</p>

<p><div class="hatena-asin-detail"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01N78FRVZ/ovis91-22/"><img src="https://images-fe.ssl-images-amazon.com/images/I/31wsxs05FPL._SL160_.jpg" class="hatena-asin-detail-image" alt="QNAP(キューナップ) TS-231P 専用OS QTS搭載 デュアルコア1.7GHz CPU 1GBメモリ 2ベイ ホーム&SOHO向け スナップショット機能対応 NAS 2年保証" title="QNAP(キューナップ) TS-231P 専用OS QTS搭載 デュアルコア1.7GHz CPU 1GBメモリ 2ベイ ホーム&SOHO向け スナップショット機能対応 NAS 2年保証"></a><div class="hatena-asin-detail-info"><p class="hatena-asin-detail-title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01N78FRVZ/ovis91-22/">QNAP(キューナップ) TS-231P 専用OS QTS搭載 デュアルコア1.7GHz CPU 1GBメモリ 2ベイ ホーム&SOHO向け スナップショット機能対応 NAS 2年保証</a></p><ul><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> QNAP(キューナップ)</li><li><span class="hatena-asin-detail-label">発売日:</span> 2016/12/09</li><li><span class="hatena-asin-detail-label">メディア:</span> Personal Computers</li><li><a href="http://d.hatena.ne.jp/asin/B01N78FRVZ/ovis91-22" target="_blank">この商品を含むブログ (5件) を見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div></p>

<p><div class="hatena-asin-detail"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B07BB7VXNB/ovis91-22/"><img src="https://images-fe.ssl-images-amazon.com/images/I/41GAvhFgYwL._SL160_.jpg" class="hatena-asin-detail-image" alt="QNAP(キューナップ) TS-453Beクアッドコア1.5 GHz CPU 2GB/4GBメモリ 4ベイ DTCP-IP/DLNA対応 ランサムウェアからも復元可" title="QNAP(キューナップ) TS-453Beクアッドコア1.5 GHz CPU 2GB/4GBメモリ 4ベイ DTCP-IP/DLNA対応 ランサムウェアからも復元可"></a><div class="hatena-asin-detail-info"><p class="hatena-asin-detail-title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B07BB7VXNB/ovis91-22/">QNAP(キューナップ) TS-453Beクアッドコア1.5 GHz CPU 2GB/4GBメモリ 4ベイ DTCP-IP/DLNA対応 ランサムウェアからも復元可</a></p><ul><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> QNAP(キューナップ)</li><li><span class="hatena-asin-detail-label">発売日:</span> 2018/04/23</li><li><span class="hatena-asin-detail-label">メディア:</span> Personal Computers</li><li><a href="http://d.hatena.ne.jp/asin/B07BB7VXNB/ovis91-22" target="_blank">この商品を含むブログを見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div></p>

<p><div class="hatena-asin-detail"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01BKYWN2C/ovis91-22/"><img src="https://images-fe.ssl-images-amazon.com/images/I/31JL28Zcc-L._SL160_.jpg" class="hatena-asin-detail-image" alt="NETGEAR NAS ディスクレス 4ベイ スマホ/タブレット対応 アンチウィルス クラウド対応 ReadyNAS 214 3年保証 RN21400-100AJS" title="NETGEAR NAS ディスクレス 4ベイ スマホ/タブレット対応 アンチウィルス クラウド対応 ReadyNAS 214 3年保証 RN21400-100AJS"></a><div class="hatena-asin-detail-info"><p class="hatena-asin-detail-title"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/B01BKYWN2C/ovis91-22/">NETGEAR NAS ディスクレス 4ベイ スマホ/タブレット対応 アンチウィルス クラウド対応 ReadyNAS 214 3年保証 RN21400-100AJS</a></p><ul><li><span class="hatena-asin-detail-label">出版社/メーカー:</span> ネットギア</li><li><span class="hatena-asin-detail-label">発売日:</span> 2016/02/18</li><li><span class="hatena-asin-detail-label">メディア:</span> Personal Computers</li><li><a href="http://d.hatena.ne.jp/asin/B01BKYWN2C/ovis91-22" target="_blank">この商品を含むブログを見る</a></li></ul></div><div class="hatena-asin-detail-foot"></div></div></p>
