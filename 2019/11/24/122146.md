---
Title: Amazon KindleストアのURLの解析
Published: 2019/11/24 12:21:46
Tags:
  - "備忘録"
Eyecatch: ""
---
<p>普段から<a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a>で<a class="keyword" href="http://d.hatena.ne.jp/keyword/%C5%C5%BB%D2%BD%F1%C0%D2">電子書籍</a>を購入してるのですが、<a class="keyword" href="http://d.hatena.ne.jp/keyword/Amazon">Amazon</a>って検索結果が妙に使い勝手が悪く、新刊を見落としてたこともしばしば。</p>

<p>きんどうなどの専門サイトで情報を<a class="keyword" href="http://d.hatena.ne.jp/keyword/%BB%C5%C6%FE">仕入</a>れてたんですが、当然全部が全部載るわけでもなく。<br/>
で、自分で検索用のアプリを作ろうと思ってちまちま書いてたもののUI作るのが面倒で放置しているうちに、しんじさん(<a href="http://blog.hatena.ne.jp/Shinji_Japan/">id:Shinji_Japan</a>)が<a class="keyword" href="http://d.hatena.ne.jp/keyword/Amazon">Amazon</a>の<a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a>検索用<a class="keyword" href="http://d.hatena.ne.jp/keyword/Chrome">Chrome</a>拡張を公開されました。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fkindle-search%2Fbckpnmiaedmiohplnmmeleogkifnmkfk" title="Kindle Search" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p><iframe src="https://hatenablog-parts.com/embed?url=http%3A%2F%2Fshinji-japan.hatenadiary.jp%2Fentry%2F2019%2F11%2F23%2F114458" title="React/TypeScriptでKindle本を検索できるChrome拡張を作ったので公開しました - shinji-japanのブログ" class="embed-card embed-blogcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<p>要望を複数対応していただいて必要十分なものになったため、アプリを作る必要がなくなったので、アプリを作るために調べていた情報だけ備忘録がてら纏めます。</p>

***

<h4>基本</h4>

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a>ストアのURLはまずこんな感じ。</p>

<p><a href="https://www.amazon.co.jp/s?k=ABC&i=digital-text&__mk_ja_JP=カタカナ&ref=nb_sb_noss_2">https://www.amazon.co.jp/s?k=ABC&i=digital-text&__mk_ja_JP=カタカナ&ref=nb_sb_noss_2</a></p>

<p>これだとABCというキーワードに対しての検索になります。<br/>
<code>k</code> のクエリ文字列がキーワードを表します。複数キーワードがある場合は+で連結。</p>

<p>上記URLのクエリ文字列のうち、<code>__mk_ja_JP</code>、<code>ref</code> は検索結果に特に影響を与えない不要なものなので、削除。</p>

<p><code>i=digital-text</code> が<a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a>ストアを表しているものの、 <code>rh</code> のクエリ文字列に対して <code>n:2250738051</code> を指定するほうが確実。</p>

<p><a href="https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051">https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051</a></p>

<h4><a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a> Unlimited対象商品のみ検索</h4>

<p>Unlimited対象商品だけを検索したい場合は、クエリ文字列<code>rh</code>に対して、</p>

<p><code>p_n_feature_nineteen_browse-bin:3169286051</code></p>

<p>を追加。すでにrhの文字列にほかの要素がある場合は <code>,</code> で連結。</p>

<p><a href="https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,p_n_feature_nineteen_browse-bin:3169286051">https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,p_n_feature_nineteen_browse-bin:3169286051</a></p>

<p>なお、Prime Readingの場合は  <code>p_n_special_merchandising_browse-bin:5304495051</code> を指定する。</p>

<h4><a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a>のカテゴリを指定</h4>

<p>上記だと、和書だけでなく洋書も混ざってしまうため、非常に探しづらい。<br/>
こういう時はカテゴリを指定してやります。</p>

<p>例えば和書を指定する場合、 <code>n:2275256051</code> を指定。</p>

<p><a href="https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,n:2275256051">https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,n:2275256051</a></p>

<p>nはBrowseNodeを表しているらしい。<br/>
カテゴリ一覧は下記のQiitaが詳しい。</p>

<p><iframe src="https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fkobake%40github%2Fitems%2F88001f62983211027f63" title="Amazonカテゴリ一覧 23,420 件（BrowseNodeデータ収集結果） - Qiita" class="embed-card embed-webcard" scrolling="no" frameborder="0" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;"></iframe></p>

<h4>期間指定</h4>

<p>公開された期間を指定したい場合、<code>p_n_date:yyyymmdd-yyyymmdd</code>を<code>rh</code>クエリに対して追加してやる。</p>

<p>ex)2019年11月1日から11月30日の期間に公開された<a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a> Unlimited
<a href="https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,n:2275256051,p_n_date:20191101-20191130,p_n_feature_nineteen_browse-bin:3169286051">https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,n:2275256051,p_n_date:20191101-20191130,p_n_feature_nineteen_browse-bin:3169286051</a></p>

<h4>価格指定</h4>

<p><code>rh</code>クエリ文字列に対して、<code>p_36</code> を追加してやることで価格を指定して検索できます。
例えば100円以上1000円以下の<a class="keyword" href="http://d.hatena.ne.jp/keyword/Kindle">Kindle</a>本を探したい場合は</p>

<p><a href="https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,n:2275256051,p_36:10000-100000">https://www.amazon.co.jp/s?k=ABC&rh=n:2250738051,n:2275256051,p_36:10000-100000</a></p>

<p>こんな感じ。実に謎なんですが、実際に探したい金額の100倍の値を指定してやらないといけない模様。</p>

<p>期間限定お試しの本を探したいときには <code>p_36:-0</code> と上限を0にしてやればOK。</p>

<p>昔は <code>low-price</code> <code>high-price</code> で指定しており、今でも使えるんですが、<code>p_36</code> に書き換えられる模様。今後も使えるかわからないので、 <code>p_36</code>の利用を推奨。<br/>
なお、 <code>high-price</code> だと探したい金額に100掛けしなくても問題なし。</p>
