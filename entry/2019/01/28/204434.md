---
Title: Google Compute Engineの無償枠を使う
Published: 2019/01/28 20:44:34
Tags:
  - "Azure・クラウド"
---
伊勢さん(id:iseebi)のTwitterでの投稿を見て初めて知ったのですが、Google Compute Engineって無償枠ってのがあったんですね。  

Google Compute EngineはいわゆるIaaS。 AWS の EC2やAzure VMと同じく、時間単位での仮想マシンリソースを提供するサービスになります。  
Google Cloud Platformの一サービスですね。  

無償枠の上限は下記の通り。  

* 1 つの非プリエンプティブ f1-micro VM インスタンス（米国リージョン(オレゴン州(us-west1)、アイオワ州(us-central1)、サウスカロライナ州(us-east1))  
* 30 GB の標準永続ディスク ストレージ（1 か月あたり）  
* 5 GB のスナップショット ストレージ（1 か月あたり）  
* トラフィックは北米の GCP リージョンから送信する必要がある
* まとめて送信できる下りトラフィックは 1 GB まで  

[oembed:"https://cloud.google.com/free/docs/always-free-usage-limits"]

メモリーは600MBと小さな仮想マシンですが、ただで使えるのは良いですね。  

早速登録しました。  

<!-- more -->



#### Google Cloud Platform の利用登録
まずページに飛んで、「無料トライアル」のボタンをクリック。  

![](20190128154954.jpg)   

利用規約の確認にチェックを入れて、「AGREE AND CONTINUE」をクリック。    
![](20190128155045.jpg) 

支払い方法などを入力して「START MY FREE TRIAL」をクリック。  
![](20190128155325.jpg) 

登録完了。  
![](20190128155428.jpg) 

#### インスタンスの作成

左メニューからCompute Engineにマウスカーソルを充てるとメニューが表示されるので、一番上のVMインスタンスをクリック。  
![](20190128155615.jpg)   

「課金を有効にする」をクリック。  
![](20190128160015.jpg) 

作成ボタンをクリック。  
![](20190128160257.jpg)   

インスタンスの作成画面が表示されます。  

![](20190128160347.jpg) 

##### 名前  
名前は適当に。わかりやすいものにしました。    
![](20190128160454.jpg)   

##### リージョン、リビジョン  
リージョンは下記のいずれかにしないと課金対象になってしまうので注意。  
* オレゴン州(us-west1)  
* アイオワ州(us-central1)  
* サウスカロライナ州(us-east1)

今回は日本に近いオレゴンにしました。  
リビジョンは特に変えてません。  
![](20190128160748.jpg) 

##### マシンタイプ  
マシンタイプはmicroにする必要があります。  
![](20190128160930.jpg) 

##### コンテナ  
今回はコンテナを使うつもりがないのでチェックは入れません。  
そもそもこのスペックでコンテナ使っても微妙な気がする・・・。   
![](20190128161043.jpg) 


##### ブートディスク  
標準の10GBの永続ディスクでもいいんですが、30GBまで使えるので変更しておきました。  
OSは標準のDebianからUbuntu LTSに。ここはよく使ってるOSにしただけで他意はなし。  
![](20190128161214.jpg) 
![](20190128161344.jpg) 

##### ID と API へのアクセス  
今回特にAPIを使うつもりもないのでデフォルトのまま。  
![](20190128161506.jpg)   

##### ファイアーウォール  
後でも設定できますが、とりあえず両方とも開けておきました。  
![](20190128161603.jpg) 

##### ネットワーキング  
外部IPアドレスの設定。  

ネットワーク インターフェースの鉛筆マークをクリック。  
![](20190128161835.jpg)   

外部IPをクリックして、IPアドレスを作成をクリック   
![](20190128162009.jpg) 

名前は適当に。  
予約ボタンをクリックすると、IPアドレスが予約されます。  
![](20190128162045.jpg)   

元の画面に戻ったら完了ボタンをクリック。  
![](20190128162205.jpg)   

ここまで終わったら作成ボタンをクリック。  
![](20190128162304.jpg)   

これで仮想マシンインスタンスが作成されました。  

![](20190128162456.jpg)   

#### SSHでの接続  

作成した仮想マシンへSSHで接続してみます。  

まずはSSH接続用に公開鍵認証の設定を。  

左メニューのメタデータをクリック。  

![](20190128170138.jpg) 

SSH認証鍵をクリック。  
![](20190128170227.jpg) 

SSH認証鍵を追加をクリック。  
![](20190128170432.jpg) 

あらかじめ作成しておいた公開鍵を記載して、登録ボタンをクリック。    
![](20190128170618.jpg) 

これでSSH認証鍵の登録は完了。  

ターミナルで秘密鍵を使ってログインしてみたところ。  
![](20190128172108.jpg) 

標準だとタイムゾーンが協定世界時になっているので、JSTに変えておく場合は下記のコマンドを実行。  
> $ sudo timedatectl set-timezone Asia/Tokyo  

実行するとJSTに切り替わります。  
![](20190128172145.jpg)   

多分これをしておかないと、Cronで設定するときにUTCで記載する必要が出てくるはず。  

あとは本当はSSHが利用するポートを変更しておくべきなのだと思いますが、とりあえずはここまで。  

#### 参考にしたサイト  

[oembed:"https://qiita.com/ndxbn/items/7ef0a96e409a5b5837bd"]  
 
[oembed:"https://blog.apar.jp/web/6966/"]

