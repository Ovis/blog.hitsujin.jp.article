---
Title: Calibreでカスタム列に値を突っ込むプログラム
Published: 2019/03/02 14:46:07
Tags:
  - "開発"
---
最近Calibreという電子書籍の管理ソフトを使ってます。  

<?# OEmbed "https://forest.watch.impress.co.jp/library/software/calibre/" /?>



このソフトでKindleの電子書籍を管理してるんですが、私はタイトル欄には書籍名と巻数のみだけ、それ以外の情報は消しておきたいというポリシーがありまして、元のタイトルはカスタム列を作成してそちらに入れるようにしています。  

こんな感じで。  

![](20190302143609.png) 

が、たくさんデータがあるといちいちタイトル欄からコピーしてカスタム列にコピーして・・・ってのが面倒。  

なので、Calibreのコマンドを利用して、一気にカスタム列にコピーするソフトを突貫で作りました。  



<?# OEmbed "https://github.com/Ovis/CalibreBulkCopyMetaData" /?>

App.config側にCalibreのパスやライブラリパス、コピー先のカラム名、コピー元のカラム名を指定してやると、コピー先カラムに値が書き込まれていない場合にコピー元カラムの値を取得して、コピー先カラムに書き込むだけ。  

また、コピー元カラムにコピー先カラム内で利用されている値が含まれている場合に、その値を書き込む処理もフラグを変更したらできるようにしてます(CopyWhenIncludedFlg)。  
上の画像でいうレーベルというカラム、単行本レーベルを登録しているんですけど、これも一個一個入れるのが面倒なので、タイトル欄に入っているならそれをコピーして入れておきたいから実装した次第。  
実装が糞なので、「ビッグコミックス」と「ビッグコミックススペシャル」みたいなものだとビッグコミックスのほうが採用されちゃうこともあるんですが、まぁいいや。  

